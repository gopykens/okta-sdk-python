{{> partials.copyrightHeader }}

import okta.models as models
from urllib.parse import urlencode


class GeneratedAPIClient():
    """
    Auto-Generated API client; implements the operations as defined in the
    OpenAPI JSON spec
    """
    def __init__(self):
        self._base_url = ""

    {{#each operations}}
    async def {{displayMethodName (snakeCase operationId)}}(
        {{operationArgumentBuilder this}}
    ):
        """
{{{pyDocstringBuilder this}}}
        """
        http_method = "{{method}}".upper()
        api_url = self.format_url(f"""
            {self._base_url}
            {{{updatePath this}}}
            """)
        {{#if queryParams.length}}
        encoded_query_params = urlencode(query_params)
        api_url += f"/?{encoded_query_params}"
        {{/if}}

        {{#if bodyModel}}
        body = {{snakeCase bodyModel}}
        {{else}}
        body = None
        {{/if}}

        request, error = await self._request_executor.create_request(
            http_method, api_url, body
        )

        if error:
            return None, error

        response, error = await self._request_executor\
            .execute(request)

        if error:
            return None, error
        {{#if responseModel}}
        try:
            result = models.{{responseModel}}(
                response.get_body()
            )
        except Exception as error:
            return None, error

        return (result, None)
        {{else}}
        return response, None
        {{/if}}

    {{/each}}
    def format_url(self, base_string):
        return ''.join(
            [line.strip() for line in base_string.splitlines()]
        )

# End of File Generation
